# jenkins-translation-tool

CLI to generate missing translation keys and missing properties files and remove
unused keys for a given language.

This is a fork from the original Perl script `translation-tool.pl` available at
the [official Jenkins project](https://github.com/jenkinsci/jenkins).

## Differences from the original tool

### No encoding conversion

The script `translation-tool.pl` tried to convert Jenkins properties from
ASCII to UTF-8 and vice-versa using regular expressions. No need to tell how
well that worked.

In fact, Jenkins use Java Properties and Jelly files to implemented
internationalization, and all translations mus be stored in files that uses
ISO-8859-1 encoding and any characters that are not supported by it must be
converted to Java entities.

The best way to achieve that is to use your preferred IDE configured to receive
UTF-8 as input and automatically convert to ISO-8859-1 with Java entities: that
you save you from a lot of headaches, leaving you to worry about normally
editing the files.

Instructions to setup that will vary depending on the IDE, but here are some
references:

- [IntelliJ IDEA](https://www.jetbrains.com/help/idea/encoding.html#file-encoding-settings)

### No editor execution

`jtt` won't execute an given editor per missing file. This might be seems as a
useful feature, but it can become a real issue if you have hundred of files to
be open in a IDE.

Different IDE's have different ways to handle that (like opening tabs), which
might be useful per see, but stills can hog down your computer if too many are
required.

The suggested workflow is to check with Git (`git status`) what changes are
being proposed and follow up from there.

## Install

### TLDR

  ```
  cpan Jenkins::i18n
  ```

### Detailed description

There are several ways to install Perl modules, all very well documented by
the community. Those external dependencies are all Perl modules available at
[CPAN](https://metacpan.org/).

Here is a list of ways to do it:

1. Install with [cpan](https://metacpan.org/dist/CPAN/view/scripts/cpan#SYNOPSIS) CLI and [local::lib](https://metacpan.org/pod/local::lib).
2. Install [perlbrew](https://perlbrew.pl/), install your personal `perl` then use `cpan` CLI.
3. Install modules as root using `cpan` CLI: worst and not recommended method.

## Development details

### Dependencies

See the `Makefile.PL` file for `TEST_REQUIRES` and `PREREQ_PM` entries.

### Testing

Once the dependencies are installed, you can run the tests available for this
module:

```
prove -lvm
```

Here is a sample:

```
$ prove -lvm
t/Jenkins-i18n.t ....
1..1
ok 1 - use Jenkins::i18n;
ok
t/removed_unused.t ..
1..15
ok 1 - dies without file parameter
ok 2 - get the expected error message
ok 3 - dies without keys parameter
ok 4 - get the expected error message
ok 5 - dies with invalid keys parameter
ok 6 - get the expected error message
# Without a license
ok 7 - got the expected number of keys removed
ok 8 - resulting properties file has the expected number of lines
ok 9 - dies with invalid license parameter
ok 10 - get the expected error message
# Restoring file
# With a license
ok 11 - got the expected number of keys removed
ok 12 - resulting properties file has the expected number of lines
# Restoring file
# With a backup
ok 13 - got the expected number of keys removed
ok 14 - resulting properties file has the expected number of lines
ok 15 - File has a backup as expected
ok
All tests successful.
Files=2, Tests=16,  0 wallclock secs ( 0.02 usr  0.00 sys +  0.14 cusr  0.01 csys =  0.17 CPU)
Result: PASS
```

## References

- [Jenkins Internationalization](https://www.jenkins.io/doc/developer/internationalization/)
- [i18n](https://wiki.mageia.org/en/What_is_i18n,_what_is_l10n)

## Copyright and licence

This software is copyright (c) 2022 of Alceu Rodrigues de Freitas Junior,
arfreitas@cpan.org

This file is part of Jenkins Translation Tool project.

Jenkins Translation Tool is free software: you can redistribute it and/or
modify it under the terms of the GNU General Public License as published by the
Free Software Foundation, either version 3 of the License, or (at your option)
any later version.

Jenkins Translation Tool is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
details.

You should have received a copy of the GNU General Public License along with
Jenkins Translation Tool. If not, see (http://www.gnu.org/licenses/).

The original `translation-tool.pl` script was licensed through the MIT License,
copyright (c) 2004-, Kohsuke Kawaguchi, Sun Microsystems, Inc., and a number
of other of contributors. Translations files generated by the Jenkins
Translation Tool CLI are distributed with the same MIT License.
